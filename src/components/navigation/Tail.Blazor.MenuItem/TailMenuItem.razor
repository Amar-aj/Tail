@inherits TailComponentBase
@using Microsoft.AspNetCore.Components.Web
@using Tail.Blazor.MenuItem

<a 
    href="@Href"
    class="@GetMenuItemClasses()"
    @onclick="HandleClick"
    style="@GetMenuItemStyles()">
    @if (Icon != null)
    {
        <span class="mr-2">@Icon</span>
    }
    <span>@ChildContent</span>
    @if (Badge != null)
    {
        <span class="ml-auto">@Badge</span>
    }
</a>

@code {
    [Parameter] public RenderFragment? ChildContent { get; set; }
    [Parameter] public RenderFragment? Icon { get; set; }
    [Parameter] public RenderFragment? Badge { get; set; }
    [Parameter] public string? Href { get; set; }
    [Parameter] public bool IsActive { get; set; }
    [Parameter] public EventCallback OnClick { get; set; }
    [Parameter] public string? Style { get; set; }

    private string GetMenuItemClasses()
    {
        var classes = new List<string> { "flex", "items-center", "px-4", "py-2", "rounded-lg", "transition-colors" };

        if (IsActive)
        {
            classes.Add("bg-primary text-white");
        }
        else
        {
            classes.Add("hover:bg-gray-100");
        }

        if (!string.IsNullOrEmpty(Class))
        {
            classes.Add(Class);
        }

        return string.Join(" ", classes);
    }

    private string GetMenuItemStyles()
    {
        var styles = new List<string>();

        if (IsActive)
        {
            styles.Add($"background-color: var(--color-primary)");
            styles.Add($"color: var(--color-text-on-primary, white)");
        }
        else
        {
            styles.Add($"color: var(--color-text-primary, black)");
        }

        if (!string.IsNullOrEmpty(Style))
        {
            styles.Add(Style);
        }

        return string.Join("; ", styles);
    }

    private async Task HandleClick()
    {
        if (OnClick.HasDelegate)
        {
            await OnClick.InvokeAsync();
        }
    }
}

