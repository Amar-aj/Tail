@inherits TailComponentBase
@using Microsoft.AspNetCore.Components.Web

<div class="@GetGroupClasses()" 
     @attributes="AdditionalAttributes" 
     style="@GetGroupStyles()"
     role="group"
     @aria-label="@AriaLabel">
    @ChildContent
</div>

@code {
    [Parameter] public RenderFragment? ChildContent { get; set; }
    [Parameter] public bool Vertical { get; set; }
    [Parameter] public ButtonGroupSpacing Spacing { get; set; } = ButtonGroupSpacing.None;
    [Parameter] public ButtonGroupSize Size { get; set; } = ButtonGroupSize.Md;
    [Parameter] public ButtonGroupBorderRadius BorderRadius { get; set; } = ButtonGroupBorderRadius.Md;
    [Parameter] public bool Attached { get; set; } = true;
    [Parameter] public bool ShowBorder { get; set; } = true;
    [Parameter] public bool ShowShadow { get; set; } = false;
    [Parameter] public string? Style { get; set; }
    [Parameter] public bool Disabled { get; set; } = false;
    [Parameter] public string? AriaLabel { get; set; }
    [Parameter] public string AnimationDuration { get; set; } = "duration-200";
    [Parameter] public bool ResponsiveVertical { get; set; } = false;
    [Parameter] public string? Variant { get; set; }

    private string GetGroupClasses()
    {
        var classes = new List<string> { "tail-button-group", AnimationDuration };

        // Layout direction
        if (Vertical)
        {
            classes.Add("tail-button-group-vertical");
        }
        else
        {
            classes.Add("tail-button-group-horizontal");
        }

        // Responsive vertical
        if (ResponsiveVertical)
        {
            classes.Add("md:tail-button-group-horizontal");
            classes.Add("tail-button-group-vertical");
        }

        // Spacing
        classes.Add(Spacing switch
        {
            ButtonGroupSpacing.None => "tail-button-group-spacing-none",
            ButtonGroupSpacing.Sm => "tail-button-group-spacing-sm",
            ButtonGroupSpacing.Md => "tail-button-group-spacing-md",
            ButtonGroupSpacing.Lg => "tail-button-group-spacing-lg",
            _ => "tail-button-group-spacing-none"
        });

        // Size
        classes.Add(Size switch
        {
            ButtonGroupSize.Xs => "tail-button-group-size-xs",
            ButtonGroupSize.Sm => "tail-button-group-size-sm",
            ButtonGroupSize.Md => "tail-button-group-size-md",
            ButtonGroupSize.Lg => "tail-button-group-size-lg",
            ButtonGroupSize.Xl => "tail-button-group-size-xl",
            _ => "tail-button-group-size-md"
        });

        // Border radius
        classes.Add(BorderRadius switch
        {
            ButtonGroupBorderRadius.None => "tail-button-group-radius-none",
            ButtonGroupBorderRadius.Sm => "tail-button-group-radius-sm",
            ButtonGroupBorderRadius.Md => "tail-button-group-radius-md",
            ButtonGroupBorderRadius.Lg => "tail-button-group-radius-lg",
            ButtonGroupBorderRadius.Full => "tail-button-group-radius-full",
            _ => "tail-button-group-radius-md"
        });

        // Attached mode
        if (Attached)
        {
            classes.Add("tail-button-group-attached");
        }
        else
        {
            classes.Add("tail-button-group-separated");
        }

        // Border
        if (ShowBorder)
        {
            classes.Add("tail-button-group-bordered");
        }

        // Shadow
        if (ShowShadow)
        {
            classes.Add("tail-button-group-shadow");
        }

        // Disabled state
        if (Disabled)
        {
            classes.Add("tail-button-group-disabled");
            classes.Add("opacity-50 cursor-not-allowed");
        }

        // Variant
        if (!string.IsNullOrEmpty(Variant))
        {
            classes.Add($"tail-button-group-{Variant}");
        }

        if (!string.IsNullOrEmpty(Class))
        {
            classes.Add(Class);
        }

        return string.Join(" ", classes);
    }

    private string GetGroupStyles()
    {
        var styles = new List<string>();

        // Use CSS variables for theming
        if (ShowBorder)
        {
            styles.Add($"border-color: var(--color-border, #e5e7eb)");
        }

        if (Disabled)
        {
            styles.Add("pointer-events: none");
        }

        if (!string.IsNullOrEmpty(Style))
        {
            styles.Add(Style);
        }

        return string.Join("; ", styles);
    }
}
