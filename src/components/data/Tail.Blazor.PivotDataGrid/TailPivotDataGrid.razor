@inherits TailComponentBase
@using Microsoft.AspNetCore.Components.Web
@using Tail.Blazor.PivotDataGrid

<div class="@GetPivotClasses()" style="@GetPivotStyles()">
    <table class="min-w-full">
        <thead>
            <tr>
                <th class="px-4 py-2 border" style="border-color: var(--color-border, #e5e7eb);">@RowHeader</th>
                @foreach (var column in Columns)
                {
                    <th class="px-4 py-2 border" style="border-color: var(--color-border, #e5e7eb);">@column</th>
                }
            </tr>
        </thead>
        <tbody>
            @foreach (var row in Rows)
            {
                <tr>
                    <td class="px-4 py-2 border font-semibold" style="border-color: var(--color-border, #e5e7eb); color: var(--color-text-primary, black);">@row.Key</td>
                    @foreach (var column in Columns)
                    {
                        <td class="px-4 py-2 border text-center" style="border-color: var(--color-border, #e5e7eb); color: var(--color-text-primary, black);">
                            @row.Values.GetValueOrDefault(column, "-")
                        </td>
                    }
                </tr>
            }
        </tbody>
    </table>
</div>

@code {
    [Parameter] public string RowHeader { get; set; } = "Row";
    [Parameter] public List<string> Columns { get; set; } = new();
    [Parameter] public List<PivotRow> Rows { get; set; } = new();
    [Parameter] public string? Style { get; set; }

    private string GetPivotClasses()
    {
        var classes = new List<string> { "overflow-x-auto", "rounded-lg", "border", "border-gray-200" };
        if (!string.IsNullOrEmpty(Class))
        {
            classes.Add(Class);
        }
        return string.Join(" ", classes);
    }

    private string GetPivotStyles()
    {
        var styles = new List<string>();
        styles.Add($"border-color: var(--color-border, #e5e7eb)");
        if (!string.IsNullOrEmpty(Style))
        {
            styles.Add(Style);
        }
        return string.Join("; ", styles);
    }
}

@code {
    public class PivotRow
    {
        public string Key { get; set; } = string.Empty;
        public Dictionary<string, string> Values { get; set; } = new();
    }
}

