@inherits Tail.Blazor.Core.TailComponentBase
@namespace Tail.Blazor.Validators

@if (ShowError)
{
    <span class="text-sm text-red-600 dark:text-red-400">@ErrorMessage</span>
}

@code {
    [Parameter] public string? Value { get; set; }
    [Parameter] public string? ErrorMessage { get; set; }

    private static readonly System.Text.RegularExpressions.Regex EmailRegex = 
        new(@"^[^@\s]+@[^@\s]+\.[^@\s]+$", System.Text.RegularExpressions.RegexOptions.Compiled);

    private bool ShowError => !string.IsNullOrEmpty(Value) && !IsValid;
    private bool IsValid => string.IsNullOrEmpty(Value) || EmailRegex.IsMatch(Value);

    protected override void OnParametersSet()
    {
        if (string.IsNullOrEmpty(ErrorMessage))
        {
            ErrorMessage = "Please enter a valid email address.";
        }
    }
}

