@inherits Tail.Blazor.Core.TailComponentBase
@namespace Tail.Blazor.Navigation

<nav class="@GetBreadcrumbClasses()" aria-label="Breadcrumb" @attributes="AdditionalAttributes">
    <ol class="flex items-center space-x-2">
        @for (int i = 0; i < Items.Count; i++)
        {
            var item = Items[i];
            var isLast = i == Items.Count - 1;
            
            <li class="flex items-center">
                @if (isLast)
                {
                    <span class="text-gray-500 dark:text-gray-400 font-medium" aria-current="page">@item.Text</span>
                }
                else
                {
                    <a href="@item.Href" 
                       class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors"
                       @onclick="() => HandleClick(item)">
                        @item.Text
                    </a>
                    <svg class="w-5 h-5 text-gray-400 mx-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                    </svg>
                }
            </li>
        }
    </ol>
</nav>

@code {
    [Parameter] public List<BreadcrumbItem> Items { get; set; } = new();
    [Parameter] public EventCallback<BreadcrumbItem> OnItemClick { get; set; }

    private string GetBreadcrumbClasses()
    {
        var classes = new List<string> { "w-full" };
        
        if (!string.IsNullOrEmpty(CssClass))
        {
            classes.Add(CssClass);
        }
        
        return string.Join(" ", classes);
    }

    private async Task HandleClick(BreadcrumbItem item)
    {
        if (OnItemClick.HasDelegate)
        {
            await OnItemClick.InvokeAsync(item);
        }
    }
}

public class BreadcrumbItem
{
    public string Text { get; set; } = "";
    public string? Href { get; set; }
    public object? Data { get; set; }
}

