@page "/components/validation"
@using Tail.Blazor.Validators
@using Tail.Blazor.Forms
@using Tail.Blazor.Core.Enums
@using Tail.Blazor.Docs.Shared
@using InputType = Tail.Blazor.Forms.InputType

<PageTitle>Form Validation - Tail.Blazor</PageTitle>

<div class="container mx-auto px-4 py-8 max-w-6xl">
    <h1 class="text-4xl font-bold mb-2" style="color: var(--color-text-primary)">Form Validation</h1>
    <p class="text-lg mb-8" style="color: var(--color-text-secondary)">
        Comprehensive form validation components with comparison operators, conditional validation, and flexible appearance options.
    </p>

    <!-- Features Overview -->
    <section class="mb-12">
        <div class="grid md:grid-cols-2 gap-6">
            <div class="p-6 rounded-lg shadow-md" style="background-color: var(--color-surface); border: 1px solid var(--color-border)">
                <h3 class="text-xl font-semibold mb-4" style="color: var(--color-text-primary)">‚ú® Key Features</h3>
                <ul class="space-y-2" style="color: var(--color-text-secondary)">
                    <li>‚úÖ Compare against predefined values or other components</li>
                    <li>üîÄ Multiple comparison operators (Equal, NotEqual, LessThan, GreaterThan, etc.)</li>
                    <li>üëÅÔ∏è Conditional validation with Visible property</li>
                    <li>üé® Flexible appearance (Inline, Block, Popup)</li>
                    <li>üéØ Customizable Style and Popup properties</li>
                    <li>üîó Compare against other form controls</li>
                    <li>üåô Full theme support</li>
                </ul>
            </div>

            <div class="p-6 rounded-lg shadow-md" style="background-color: var(--color-surface); border: 1px solid var(--color-border)">
                <h3 class="text-xl font-semibold mb-4" style="color: var(--color-text-primary)">üéØ Validation Types</h3>
                <ul class="space-y-2" style="color: var(--color-text-secondary)">
                    <li><strong>TailCompareValidator</strong> - Compare values</li>
                    <li><strong>TailRequiredValidator</strong> - Required field validation</li>
                    <li><strong>TailEmailValidator</strong> - Email format validation</li>
                    <li><strong>TailCustomValidator</strong> - Custom validation function</li>
                    <li><strong>TailRegexValidator</strong> - Pattern matching</li>
                    <li><strong>TailLengthValidator</strong> - Length validation</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Compare Validator - Basic -->
    <section class="mb-12">
        <h2 class="text-3xl font-bold mb-4" style="color: var(--color-text-primary)">Compare Validator</h2>
        <p class="mb-6" style="color: var(--color-text-secondary)">
            Compare user input against predefined values or other components with various operators.
        </p>

        <CodePreview Title="Password Confirmation" Code="@passwordConfirmCode">
            <PreviewContent>
                <div class="max-w-md space-y-4">
                    <div>
                        <TailInput 
                            Label="Password" 
                            InputType="InputType.Password" 
                            Value="@password" 
                            ValueChanged="v => password = v"
                            Placeholder="Enter password" />
                    </div>
                    <div class="relative">
                        <TailInput 
                            id="confirm-password"
                            Label="Confirm Password" 
                            InputType="InputType.Password" 
                            Value="@confirmPassword" 
                            ValueChanged="v => confirmPassword = v"
                            Placeholder="Confirm password" />
                        <TailCompareValidator 
                            Value="@confirmPassword"
                            CompareTo="@password"
                            Operator="CompareOperator.Equal"
                            ErrorMessage="Passwords do not match"
                            ControlToCompare="confirm-password"
                            Appearance="ValidationAppearance.Inline" />
                    </div>
                </div>
            </PreviewContent>
        </CodePreview>
    </section>

    <!-- Comparison Operators -->
    <section class="mb-12">
        <h2 class="text-3xl font-bold mb-4" style="color: var(--color-text-primary)">Comparison Operators</h2>
        <p class="mb-6" style="color: var(--color-text-secondary)">
            Use different operators to compare values: Equal, NotEqual, LessThan, GreaterThan, LessThanOrEqual, GreaterThanOrEqual.
        </p>

        <CodePreview Title="All Comparison Operators" Code="@comparisonOperatorsCode">
            <PreviewContent>
                <div class="max-w-md space-y-4">
                    <div>
                        <TailInput 
                            Label="Age" 
                            InputType="InputType.Number" 
                            Value="@age" 
                            ValueChanged="v => age = v"
                            Placeholder="Enter age" />
                        <TailCompareValidator 
                            Value="@age"
                            CompareTo="@ageCompareValue"
                            Operator="CompareOperator.GreaterThanOrEqual"
                            ErrorMessage="Must be 18 or older"
                            Appearance="ValidationAppearance.Inline" />
                    </div>
                    <div>
                        <TailInput 
                            Label="Quantity" 
                            InputType="InputType.Number" 
                            Value="@quantity" 
                            ValueChanged="v => quantity = v"
                            Placeholder="Enter quantity" />
                        <TailCompareValidator 
                            Value="@quantity"
                            CompareTo="@quantityCompareValue"
                            Operator="CompareOperator.LessThanOrEqual"
                            ErrorMessage="Maximum quantity is 10"
                            Appearance="ValidationAppearance.Inline" />
                    </div>
                    <div>
                        <TailInput 
                            Label="Price" 
                            InputType="InputType.Number" 
                            Value="@price" 
                            ValueChanged="v => price = v"
                            Placeholder="Enter price" />
                        <TailCompareValidator 
                            Value="@price"
                            CompareTo="@priceCompareValue"
                            Operator="CompareOperator.GreaterThan"
                            ErrorMessage="Price must be greater than 0"
                            Appearance="ValidationAppearance.Inline" />
                    </div>
                </div>
            </PreviewContent>
        </CodePreview>
    </section>

    <!-- Appearance Options -->
    <section class="mb-12">
        <h2 class="text-3xl font-bold mb-4" style="color: var(--color-text-primary)">Appearance Options</h2>
        <p class="mb-6" style="color: var(--color-text-secondary)">
            Choose how validation messages appear: Inline, Block, or Popup.
        </p>

        <CodePreview Title="Inline Appearance" Code="@inlineAppearanceCode">
            <PreviewContent>
                <div class="max-w-md space-y-4">
                    <div>
                        <TailInput 
                            Label="Email" 
                            InputType="InputType.Email" 
                            Value="@email1" 
                            ValueChanged="v => email1 = v"
                            Placeholder="Enter email" />
                        <TailEmailValidator 
                            Value="@email1"
                            Appearance="ValidationAppearance.Inline" />
                    </div>
                </div>
            </PreviewContent>
        </CodePreview>

        <CodePreview Title="Block Appearance" Code="@blockAppearanceCode">
            <PreviewContent>
                <div class="max-w-md space-y-4">
                    <div>
                        <TailInput 
                            Label="Username" 
                            InputType="InputType.Text" 
                            Value="@username" 
                            ValueChanged="v => username = v"
                            Placeholder="Enter username" />
                        <TailRequiredValidator 
                            Value="@username"
                            Appearance="ValidationAppearance.Block" />
                    </div>
                </div>
            </PreviewContent>
        </CodePreview>

        <CodePreview Title="Popup Appearance" Code="@popupAppearanceCode">
            <PreviewContent>
                <div class="max-w-md space-y-4">
                    <div class="relative">
                        <TailInput 
                            id="popup-email"
                            Label="Email" 
                            InputType="InputType.Email" 
                            Value="@email2" 
                            ValueChanged="v => email2 = v"
                            Placeholder="Enter email" />
                        <TailEmailValidator 
                            Value="@email2"
                            Appearance="ValidationAppearance.Popup"
                            ControlToCompare="popup-email" />
                    </div>
                </div>
            </PreviewContent>
        </CodePreview>
    </section>

    <!-- Conditional Validation -->
    <section class="mb-12">
        <h2 class="text-3xl font-bold mb-4" style="color: var(--color-text-primary)">Conditional Validation</h2>
        <p class="mb-6" style="color: var(--color-text-secondary)">
            Use the Visible property to conditionally show/hide validation messages.
        </p>

        <CodePreview Title="Conditional Validation" Code="@conditionalValidationCode">
            <PreviewContent>
                <div class="max-w-md space-y-4">
                    <div>
                        <TailInput 
                            Label="Phone Number" 
                            InputType="InputType.Tel" 
                            Value="@phone" 
                            ValueChanged="v => phone = v"
                            Placeholder="Enter phone number" />
                        <TailRequiredValidator 
                            Value="@phone"
                            Visible="@showPhoneValidation"
                            Appearance="ValidationAppearance.Inline" />
                    </div>
                    <div>
                        <TailSwitch 
                            Label="Enable Phone Validation"
                            @bind-IsChecked="showPhoneValidation" />
                    </div>
                </div>
            </PreviewContent>
        </CodePreview>
    </section>

    <!-- Custom Style -->
    <section class="mb-12">
        <h2 class="text-3xl font-bold mb-4" style="color: var(--color-text-primary)">Custom Styling</h2>
        <p class="mb-6" style="color: var(--color-text-secondary)">
            Customize validation message appearance with Style and Popup properties.
        </p>

        <CodePreview Title="Custom Style" Code="@customStyleCode">
            <PreviewContent>
                <div class="max-w-md space-y-4">
                    <div>
                        <TailInput 
                            Label="Custom Styled Validation" 
                            InputType="InputType.Text" 
                            Value="@customValue" 
                            ValueChanged="v => customValue = v"
                            Placeholder="Enter value" />
                        <TailRequiredValidator 
                            Value="@customValue"
                            Appearance="ValidationAppearance.Block"
                            Style="font-weight: bold; font-size: 14px; padding: 8px;" />
                    </div>
                    <div>
                        <TailInput 
                            id="custom-popup"
                            Label="Custom Popup Style" 
                            InputType="InputType.Text" 
                            Value="@customValue2" 
                            ValueChanged="v => customValue2 = v"
                            Placeholder="Enter value" />
                        <TailRequiredValidator 
                            Value="@customValue2"
                            Appearance="ValidationAppearance.Popup"
                            Popup="top: 110%; left: 0; max-width: 300px;"
                            ControlToCompare="custom-popup" />
                    </div>
                </div>
            </PreviewContent>
        </CodePreview>
    </section>

    <!-- Complete Form Example -->
    <section class="mb-12">
        <h2 class="text-3xl font-bold mb-4" style="color: var(--color-text-primary)">Complete Form Example</h2>
        <p class="mb-6" style="color: var(--color-text-secondary)">
            A complete registration form showcasing multiple validators working together.
        </p>

        <CodePreview Title="Registration Form" Code="@completeFormCode">
            <PreviewContent>
                <div class="max-w-md space-y-4">
                    <div>
                        <TailInput 
                            Label="Email" 
                            InputType="InputType.Email" 
                            Value="@formEmail" 
                            ValueChanged="v => formEmail = v"
                            Placeholder="Enter email" />
                        <TailEmailValidator 
                            Value="@formEmail"
                            Appearance="ValidationAppearance.Inline" />
                    </div>
                    <div>
                        <TailInput 
                            Label="Password" 
                            InputType="InputType.Password" 
                            Value="@formPassword" 
                            ValueChanged="v => formPassword = v"
                            Placeholder="Enter password" />
                        <TailRequiredValidator 
                            Value="@formPassword"
                            Appearance="ValidationAppearance.Inline" />
                    </div>
                    <div class="relative">
                        <TailInput 
                            id="form-confirm-password"
                            Label="Confirm Password" 
                            InputType="InputType.Password" 
                            Value="@formConfirmPassword" 
                            ValueChanged="v => formConfirmPassword = v"
                            Placeholder="Confirm password" />
                        <TailCompareValidator 
                            Value="@formConfirmPassword"
                            CompareTo="@formPassword"
                            Operator="CompareOperator.Equal"
                            ErrorMessage="Passwords must match"
                            ControlToCompare="form-confirm-password"
                            Appearance="ValidationAppearance.Popup" />
                    </div>
                    <div>
                        <TailInput 
                            Label="Age" 
                            InputType="InputType.Number" 
                            Value="@formAge" 
                            ValueChanged="v => formAge = v"
                            Placeholder="Enter age" />
                        <TailCompareValidator 
                            Value="@formAge"
                            CompareTo="@formAgeCompareValue"
                            Operator="CompareOperator.GreaterThanOrEqual"
                            ErrorMessage="Must be 18 or older"
                            Visible="@IsAgeValid"
                            Appearance="ValidationAppearance.Inline" />
                    </div>
                </div>
            </PreviewContent>
        </CodePreview>
    </section>

    <!-- API Reference -->
    <section class="mb-12">
        <h2 class="text-3xl font-bold mb-4" style="color: var(--color-text-primary)">API Reference</h2>
        
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y" style="border: 1px solid var(--color-border)">
                <thead style="background-color: var(--color-surface-2)">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium uppercase" style="color: var(--color-text-primary)">Parameter</th>
                        <th class="px-6 py-3 text-left text-xs font-medium uppercase" style="color: var(--color-text-primary)">Type</th>
                        <th class="px-6 py-3 text-left text-xs font-medium uppercase" style="color: var(--color-text-primary)">Default</th>
                        <th class="px-6 py-3 text-left text-xs font-medium uppercase" style="color: var(--color-text-primary)">Description</th>
                    </tr>
                </thead>
                <tbody class="divide-y" style="background-color: var(--color-surface); border-color: var(--color-border)">
                    <tr>
                        <td class="px-6 py-4 text-sm font-mono" style="color: var(--color-text-primary)">Value</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">object?</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">null</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">Value to validate</td>
                    </tr>
                    <tr>
                        <td class="px-6 py-4 text-sm font-mono" style="color: var(--color-text-primary)">CompareTo</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">object?</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">null</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">Value to compare against (for TailCompareValidator)</td>
                    </tr>
                    <tr>
                        <td class="px-6 py-4 text-sm font-mono" style="color: var(--color-text-primary)">Operator</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">CompareOperator</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">Equal</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">Comparison operator: Equal, NotEqual, LessThan, GreaterThan, LessThanOrEqual, GreaterThanOrEqual</td>
                    </tr>
                    <tr>
                        <td class="px-6 py-4 text-sm font-mono" style="color: var(--color-text-primary)">Visible</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">bool</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">true</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">Show/hide validation message conditionally</td>
                    </tr>
                    <tr>
                        <td class="px-6 py-4 text-sm font-mono" style="color: var(--color-text-primary)">Appearance</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">ValidationAppearance</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">Inline</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">Message appearance: Inline, Block, or Popup</td>
                    </tr>
                    <tr>
                        <td class="px-6 py-4 text-sm font-mono" style="color: var(--color-text-primary)">Style</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">string?</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">null</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">Custom CSS styles for validation message</td>
                    </tr>
                    <tr>
                        <td class="px-6 py-4 text-sm font-mono" style="color: var(--color-text-primary)">Popup</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">string?</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">null</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">Custom CSS styles specifically for popup appearance (overrides Style when Appearance is Popup)</td>
                    </tr>
                    <tr>
                        <td class="px-6 py-4 text-sm font-mono" style="color: var(--color-text-primary)">ControlToCompare</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">string?</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">null</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">ID of the control to position popup relative to</td>
                    </tr>
                    <tr>
                        <td class="px-6 py-4 text-sm font-mono" style="color: var(--color-text-primary)">ErrorMessage</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">string?</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">null</td>
                        <td class="px-6 py-4 text-sm" style="color: var(--color-text-secondary)">Custom error message to display</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>
</div>

@code {
    private string? password;
    private string? confirmPassword;
    private string? age;
    private string? quantity;
    private string? price;
    private string? email1;
    private string? email2;
    private string? username;
    private string? phone;
    private bool showPhoneValidation = true;
    private string? customValue;
    private string? customValue2;
    private string? formEmail;
    private string? formPassword;
    private string? formConfirmPassword;
    private string? formAge;
    
    // Comparison values
    private int ageCompareValue = 18;
    private int quantityCompareValue = 10;
    private int priceCompareValue = 0;
    private int formAgeCompareValue = 18;
    
    // Helper method to check if age is valid for comparison
    private bool IsAgeValid => !string.IsNullOrEmpty(formAge) && int.TryParse(formAge, out var ageVal) && ageVal > 0;

    private string passwordConfirmCode = @"<TailInput 
    Label=""Password"" 
    InputType=""InputType.Password"" 
    Value=""@password"" 
    ValueChanged=""v => password = v"" />

<TailInput 
    id=""confirm-password""
    Label=""Confirm Password"" 
    InputType=""InputType.Password"" 
    Value=""@confirmPassword"" 
    ValueChanged=""v => confirmPassword = v"" />

<TailCompareValidator 
    Value=""@confirmPassword""
    CompareTo=""@password""
    Operator=""CompareOperator.Equal""
    ErrorMessage=""Passwords do not match""
    ControlToCompare=""confirm-password""
    Appearance=""ValidationAppearance.Inline"" />";

    private string comparisonOperatorsCode = @"<TailInput 
    Label=""Age"" 
    InputType=""InputType.Number"" 
    Value=""@age"" 
    ValueChanged=""v => age = v"" />

<TailCompareValidator 
    Value=""@age""
    CompareTo=""18""
    Operator=""CompareOperator.GreaterThanOrEqual""
    ErrorMessage=""Must be 18 or older""
    Appearance=""ValidationAppearance.Inline"" />";

    private string inlineAppearanceCode = @"<TailInput 
    Label=""Email"" 
    InputType=""InputType.Email"" 
    Value=""@email"" 
    ValueChanged=""v => email = v"" />

<TailEmailValidator 
    Value=""@email""
    Appearance=""ValidationAppearance.Inline"" />";

    private string blockAppearanceCode = @"<TailInput 
    Label=""Username"" 
    InputType=""InputType.Text"" 
    Value=""@username"" 
    ValueChanged=""v => username = v"" />

<TailRequiredValidator 
    Value=""@username""
    Appearance=""ValidationAppearance.Block"" />";

    private string popupAppearanceCode = @"<div class=""relative"">
    <TailInput 
        id=""popup-email""
        Label=""Email"" 
        InputType=""InputType.Email"" 
        Value=""@email"" 
        ValueChanged=""v => email = v"" />
    <TailEmailValidator 
        Value=""@email""
        Appearance=""ValidationAppearance.Popup""
        ControlToCompare=""popup-email"" />
</div>";

    private string conditionalValidationCode = @"<TailInput 
    Label=""Phone Number"" 
    InputType=""InputType.Tel"" 
    Value=""@phone"" 
    ValueChanged=""v => phone = v"" />

<TailRequiredValidator 
    Value=""@phone""
    Visible=""@showPhoneValidation""
    Appearance=""ValidationAppearance.Inline"" />

<TailSwitch 
    Label=""Enable Phone Validation""
    @bind-IsChecked=""showPhoneValidation"" />";

    private string customStyleCode = @"<TailInput 
    Label=""Custom Styled Validation"" 
    InputType=""InputType.Text"" 
    Value=""@value"" 
    ValueChanged=""v => value = v"" />

<TailRequiredValidator 
    Value=""@value""
    Appearance=""ValidationAppearance.Block""
    Style=""font-weight: bold; font-size: 14px; padding: 8px;"" />";

    private string completeFormCode = @"<TailInput 
    Label=""Email"" 
    InputType=""InputType.Email"" 
    Value=""@email"" 
    ValueChanged=""v => email = v"" />
<TailEmailValidator 
    Value=""@email""
    Appearance=""ValidationAppearance.Inline"" />

<TailInput 
    Label=""Password"" 
    InputType=""InputType.Password"" 
    Value=""@password"" 
    ValueChanged=""v => password = v"" />
<TailRequiredValidator 
    Value=""@password""
    Appearance=""ValidationAppearance.Inline"" />

<TailInput 
    id=""confirm-password""
    Label=""Confirm Password"" 
    InputType=""InputType.Password"" 
    Value=""@confirmPassword"" 
    ValueChanged=""v => confirmPassword = v"" />
<TailCompareValidator 
    Value=""@confirmPassword""
    CompareTo=""@password""
    Operator=""CompareOperator.Equal""
    ErrorMessage=""Passwords must match""
    ControlToCompare=""confirm-password""
    Appearance=""ValidationAppearance.Popup"" />";
}

